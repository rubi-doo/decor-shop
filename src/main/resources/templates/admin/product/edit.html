<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/admin-layout}">
<head>
<title>Cập Nhật Sản Phẩm</title>
</head>

<body>
	<section layout:fragment="content">
		<div class="container-xxl container-p-y">
			<h4 class="fw-bold py-3 mb-4">
				<span class="text-muted fw-light">Quản Lý Sản Phẩm /</span> Cập Nhật Sản Phẩm
			</h4>

			<div class="card mb-4">
				<div
					class="card-header d-flex justify-content-between align-items-center">
					<h5 class="mb-0">Thông Tin Sản Phẩm</h5>
				</div>
				<div class="card-body">
					<form th:action="@{/admin/products/edit/{id}(id=${product.id})}"
						th:object="${product}" method="post" enctype="multipart/form-data">

						<!-- Name -->
						<div class="row mb-3">
							<label class="col-sm-2 col-form-label" for="name">Tên</label>
							<div class="col-sm-10">
								<input type="text" th:field="*{name}" id="name"
									class="form-control" placeholder="Tên Sản Phẩm" />
							</div>
						</div>

						<!-- Price -->
						<div class="row mb-3">
							<label class="col-sm-2 col-form-label" for="price">Giá</label>
							<div class="col-sm-10">
								<input type="number" th:field="*{price}" id="price"
									class="form-control" step="any" placeholder="Nhập giá" />
							</div>
						</div>

						<!-- Quantity -->
						<div class="row mb-3">
							<label class="col-sm-2 col-form-label" for="quantity">Số Lượng</label>
							<div class="col-sm-10">
								<input type="number" th:field="*{quantity}" id="quantity"
									class="form-control" placeholder="Số lượng tồn kho" />
							</div>
						</div>

						<!-- Description -->
						<div class="row mb-3">
							<label class="col-sm-2 col-form-label" for="description">Mô tả</label>
							<div class="col-sm-10">
								<textarea th:field="*{description}" id="description"
									class="form-control" rows="3" placeholder="Product description"></textarea>
							</div>
						</div>

						<!-- Category -->
						<div class="row mb-3">
							<label class="col-sm-2 col-form-label" for="category">Danh Mục</label>
							<div class="col-sm-10">
								<select th:field="*{category}" class="form-select" id="category">
									<option value="" disabled selected>-- Chọn danh mục
										--</option>
									<option th:each="cat : ${categories}" th:value="${cat.id}"
										th:text="${cat.name}"></option>
								</select>
							</div>
						</div>

						<!-- Image Upload -->
						<div class="row mb-3">
							<label class="col-sm-2 col-form-label" for="imageUpload">Ảnh</label>
							<div class="col-sm-10">
								<div class="input-group">
									<input type="file" name="imageFile" class="form-control"
										id="imageUpload" />
								</div>
								<div class="mt-1" th:if="${product.imageUrl != null}">
									<small class="text-muted">Current file: <span
										th:text="${product.imageUrl}">image.jpg</span></small>
								</div>
								<div class="mt-3">
									<img id="imagePreview"
										th:src="@{'/uploads/' + ${product.imageUrl}}"
										onerror="this.onerror=null; this.src='/images/' + this.getAttribute('data-fallback');"
										th:attr="alt=${product.name}, data-fallback=${product.imageUrl}"
										th:style="${product.imageUrl != null} ? 'max-height: 150px; border-radius: 8px;' : 'display: none;'"
										class="img-thumbnail" />
								</div>
							</div>
						</div>

						<!-- Status -->
						<div class="row mb-4">
							<label class="col-sm-2 col-form-label d-block">Trạng Thái</label>
							<div class="col-sm-10">
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio"
										th:field="*{status}" value="1" id="active"
										th:checked="${product.status == null or product.status == 1}" />
									<label class="form-check-label" for="active">Hiển thị</label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio"
										th:field="*{status}" value="0" id="inactive"
										th:checked="${product.status != null and product.status == 0}" />
									<label class="form-check-label" for="inactive">Ẩn</label>
								</div>
							</div>
						</div>

						<!-- Buttons -->
						<div class="row justify-content-end">
							<div class="col-sm-10">
								<button type="submit" class="btn btn-primary me-2">
									<i class="bx bx-save"></i> Lưu
								</button>
								<a th:href="@{/admin/products}" class="btn btn-secondary"> <i
									class="bx bx-arrow-back"></i> Hủy
								</a>
							</div>
						</div>

					</form>
				</div>
			</div>
		</div>
	</section>
</body>
</html>
